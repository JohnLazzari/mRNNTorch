

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fp &mdash; mRNNTorch 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            mRNNTorch
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="mrnntorch.html">mrnntorch</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mRNNTorch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">fp</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mrnntorch.analysis.fixed_points.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-mrnntorch.analysis.fixed_points.fp">
<span id="fp"></span><h1>fp<a class="headerlink" href="#module-mrnntorch.analysis.fixed_points.fp" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mrnntorch.analysis.fixed_points.fp.</span></span><span class="sig-name descname"><span class="pre">FixedPointCollection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xstar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_xstar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qstar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_unique</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.float32</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype_complex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">complex</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">torch.complex64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for storing fixed points and associated data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.assert_valid_shapes">
<span class="sig-name descname"><span class="pre">assert_valid_shapes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.assert_valid_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.assert_valid_shapes" title="Link to this definition"></a></dt>
<dd><p>Checks that all data attributes reflect the same number of fixed
points.</p>
<dl class="simple">
<dt>Raises:</dt><dd><p>AssertionError if any non-None data attribute does not have
.shape[0] as self.n.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.concatenate">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concatenate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.concatenate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.concatenate" title="Link to this definition"></a></dt>
<dd><p>Join a sequence of FixedPoints objects.</p>
<dl>
<dt>Args:</dt><dd><p>fps_seq: sequence of FixedPoints objects. All FixedPoints objects
must have the following attributes in common:</p>
<blockquote>
<div><p>n_states
n_inputs</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>A FixedPoints objects containing the concatenated FixedPoints data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.find" title="Link to this definition"></a></dt>
<dd><p>Searches in the current FixedPoints object for matches to a
specified fixed point. Two fixed points are defined as matching
if the 2-norm of the difference between their concatenated (xstar,
inputs) is within tol_unique).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>fp: A FixedPoints object containing exactly one fixed point.</p>
</dd>
<dt>Returns:</dt><dd><p>shape (n_matches,) tensor specifying indices into the current
FixedPoints object where matches to fp were found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.get_unique">
<span class="sig-name descname"><span class="pre">get_unique</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.get_unique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.get_unique" title="Link to this definition"></a></dt>
<dd><p>Identifies unique fixed points. Among duplicates identified,
this keeps the one with smallest qstar.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None.</p>
</dd>
<dt>Returns:</dt><dd><p>A FixedPoints object containing only the unique fixed points and
their associated data. Uniqueness is determined down to tol_unique.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.is_single_fixed_point">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_single_fixed_point</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.is_single_fixed_point" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.kwargs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kwargs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.kwargs" title="Link to this definition"></a></dt>
<dd><p>Returns dict of keyword arguments necessary for reinstantiating a
(shallow) copy of this FixedPoints object, i.e.,</p>
<p>fp_copy  = FixedPoints(<a href="#id1"><span class="problematic" id="id2">**</span></a>fp.kwargs)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.restore">
<span class="sig-name descname"><span class="pre">restore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restore_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.restore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.restore" title="Link to this definition"></a></dt>
<dd><p>Restores data from a previously saved FixedPoints object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>restore_path: A string containing the path at which to find a
previously saved FixedPoints object (including directory, filename,
and extension).</p>
</dd>
<dt>Returns:</dt><dd><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.save" title="Link to this definition"></a></dt>
<dd><p>Saves all data contained in the FixedPoints object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>save_path: A string containing the path at which to save
(including directory, filename, and arbitrary extension).</p>
</dd>
<dt>Returns:</dt><dd><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.transform" title="Link to this definition"></a></dt>
<dd><p>Apply an affine transformation to the state-space representation.
This may be helpful for plotting fixed points in a given linear
subspace (e.g., PCA or an RNN readout space).</p>
<dl>
<dt>Args:</dt><dd><p>U: shape (n_states, k) numpy array projection matrix.</p>
<p>offset (optional): shape (k,) numpy translation vector. Default: 0.</p>
</dd>
<dt>Returns:</dt><dd><p>A FixedPoints object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp.FixedPointCollection.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp.html#FixedPointCollection.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection.update" title="Link to this definition"></a></dt>
<dd><p>Combines the entries from another FixedPoints object into this
object.</p>
<dl>
<dt>Args:</dt><dd><p>new_fps: a FixedPoints object containing the entries to be
incorporated into this FixedPoints object.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
<dt>Raises:</dt><dd><p>AssertionError if the non-fixed-point specific attributes of
new_fps do not match those of this FixedPoints object.</p>
<p>AssertionError if any data attributes are found in one but not both
FixedPoints objects (especially relevant for decomposed Jacobians).</p>
<p>AssertionError if the updated object has inconsistent data shapes.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mrnntorch.analysis.fixed_points.fp_finder">
<span id="fp-finder"></span><h1>fp_finder<a class="headerlink" href="#module-mrnntorch.analysis.fixed_points.fp_finder" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mrnntorch.analysis.fixed_points.fp_finder.</span></span><span class="sig-name descname"><span class="pre">FixedPointFinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mrnn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mrnntorch.html#mrnntorch.mRNN.mRNN" title="mrnntorch.mRNN.mRNN"><span class="pre">mRNN</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_cooldown</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_dq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_rerun_q_outliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_q_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_exclude_distance_outliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_distance_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_unique</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_unique</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">super_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters_per_print_update</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.decompose_jacobian">
<span class="sig-name descname"><span class="pre">decompose_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.decompose_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.decompose_jacobian" title="Link to this definition"></a></dt>
<dd><p>Wrapper around linearization object decomposition for current fixed points</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.default_hps">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_hps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.default_hps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.default_hps" title="Link to this definition"></a></dt>
<dd><p>Returns a deep copy of the default hyperparameters dict.</p>
<p>The deep copy protects against external updates to the defaults, which
in turn protects against unintended interactions with the hashing done
by the Hyperparameters class.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None.</p>
</dd>
<dt>Returns:</dt><dd><p>dict of hyperparameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.find_fixed_points">
<span class="sig-name descname"><span class="pre">find_fixed_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stim_inp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_rec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_inp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rounds_q_opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="mrnntorch.analysis.fixed_points.fp.FixedPointCollection"><span class="pre">FixedPointCollection</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="mrnntorch.analysis.fixed_points.fp.FixedPointCollection"><span class="pre">FixedPointCollection</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.find_fixed_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.find_fixed_points" title="Link to this definition"></a></dt>
<dd><p>Finds RNN fixed points and the Jacobians at the fixed points.</p>
<dl>
<dt>Args:</dt><dd><p>initial_states: Tensor specifying the initial
states of the RNN, from which the optimization will search for
fixed points.</p>
<p>ext_inputs: external inputs to the RNN</p>
<p>stim_inp: Additional stimulus input to the network</p>
<p>W_rec: Fixed weight matrix to replace self.mrnn.W_rec in forward
pass</p>
<p>W_rec: Fixed weight matrix to replace self.mrnn.W_inp in forward
pass</p>
<p>n_rounds_q_opt: Number of rounds to run extra iterations on q
outliers</p>
</dd>
<dt>Returns:</dt><dd><p>unique_fps: A FixedPoints object containing the set of unique
fixed points after optimizing from all initial_states. Two fixed
points are considered unique if all absolute element-wise
differences are less than tol_unique AND the corresponding inputs
are unique following the same criteria. See FixedPoints.py for
additional detail.</p>
<p>all_fps: A FixedPoints object containing the likely redundant set
of fixed points (and associated metadata) resulting from ALL
initializations in initial_states (i.e., the full set of fixed
points before filtering out putative duplicates to yield
unique_fps).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_fp_non_distance_outliers">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_fp_non_distance_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="mrnntorch.analysis.fixed_points.fp.FixedPointCollection"><span class="pre">FixedPointCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.get_fp_non_distance_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_fp_non_distance_outliers" title="Link to this definition"></a></dt>
<dd><p>get fixed points that are far from initial states based on threshold.
Args:</p>
<blockquote>
<div><p>fps (FixedPointCollection): fps discovered [n, state_dim]
initial_states (Tensor): initial states of optimization [n, state_dim]
dist_thresh (float): threshold at which fixed points are considered far</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>fsp_non_outlier_distance (Tensor): indices to fps object that are not far</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_init_non_distance_outliers">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_init_non_distance_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.get_init_non_distance_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_init_non_distance_outliers" title="Link to this definition"></a></dt>
<dd><p>get initial states that are far from centroid based on threshold.
Args:</p>
<blockquote>
<div><p>initial_states (Tensor): initial states of fp optimization [n, state_dim]
dist_thresh (float): Threshold from initial states which is far.</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>init_non_outlier_idx (Tensor): indices to initial_states tensor inside threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.get_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.get_jacobian" title="Link to this definition"></a></dt>
<dd><p>Wrapper around linearization object jacobian for current fixed points</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.identify_q_non_outliers">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identify_q_non_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="mrnntorch.analysis.fixed_points.fp.FixedPointCollection"><span class="pre">FixedPointCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.identify_q_non_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.identify_q_non_outliers" title="Link to this definition"></a></dt>
<dd><p>Identify fixed points with optimized q values that do not exceed a
specified threshold.</p>
<dl>
<dt>Args:</dt><dd><p>fps: A FixedPoints object containing optimized fixed points and
associated metadata.</p>
<p>q_thresh: A scalar float indicating the threshold on fixed points’
q values.</p>
</dd>
<dt>Returns:</dt><dd><p>A tensor containing the indices into fps corresponding to the
fixed points with q values that do not exceed the threshold.</p>
</dd>
<dt>Usage:</dt><dd><p>idx = identify_q_non_outliers(fps, q_thresh)
non_outlier_fps = fps[idx]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.identify_q_outliers">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identify_q_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mrnntorch.analysis.fixed_points.fp.FixedPointCollection" title="mrnntorch.analysis.fixed_points.fp.FixedPointCollection"><span class="pre">FixedPointCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.identify_q_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.identify_q_outliers" title="Link to this definition"></a></dt>
<dd><p>Identify fixed points with optimized q values that exceed a
specified threshold.</p>
<dl>
<dt>Args:</dt><dd><p>fps: A FixedPoints object containing optimized fixed points and
associated metadata.</p>
<p>q_thresh: A scalar float indicating the threshold on fixed
points’ q values.</p>
</dd>
<dt>Returns:</dt><dd><p>A tensor containing the indices into fps corresponding to
the fixed points with q values exceeding the threshold.</p>
</dd>
<dt>Usage:</dt><dd><p>idx = identify_q_outliers(fps, q_thresh)
outlier_fps = fps[idx]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.sample_states">
<span class="sig-name descname"><span class="pre">sample_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_zero_tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/mrnntorch/analysis/fixed_points/fp_finder.html#FixedPointFinder.sample_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrnntorch.analysis.fixed_points.fp_finder.FixedPointFinder.sample_states" title="Link to this definition"></a></dt>
<dd><p>Draws random samples from trajectories of the RNN state. Samples
can optionally be corrupted by independent and identically distributed
(IID) Gaussian noise. These samples are intended to be used as initial
states for fixed point optimizations.</p>
<dl>
<dt>Args:</dt><dd><p>state_traj: 1D or ND tensor containing
example trajectories of the RNN state.</p>
<p>n_inits: int specifying the number of sampled states to return.</p>
<p>noise_scale (optional): non-negative float specifying the standard
deviation of IID Gaussian noise samples added to the sampled
states.</p>
<p>exclude_zero_tensors (bool, optional): whether to exclude zeros
tensors that may be in state_traj</p>
</dd>
<dt>Returns:</dt><dd><p>initial_states: Sampled RNN states as a [n_inits x n_states] tensor</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError if noise_scale is negative.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, John Lazzari.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>